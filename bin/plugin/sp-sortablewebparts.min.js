/*!
 * Sortable Web Parts for SharePoint 2013
 * Christopher Parsons <cparsons@habaneroconsulting.com>
 * Habanero Consulting Group - Licensed under MIT
 */
!function(a,b,c,d){"use strict";var e,f={},g={placeholder:".ui-sortable-placeholder",webpart:".ms-webpartzone-cell",zone:".ms-SPZone"},h="MSOZone_EmptyZoneCell",i=g.placeholder+" + "+g.webpart+", "+g.placeholder+" + #"+h;f.prototypeSetup=function(){HTMLDivElement.prototype.swapNode=function(a){if(null===a)return!1;var b=this.parentNode.insertBefore(c.createTextNode(""),this);return a.parentNode.insertBefore(this,a),b.parentNode.insertBefore(a,b),b.parentNode.removeChild(b),this},HTMLDivElement.prototype.removeNode=function(){this.parentNode.removeChild(this)}},f.setup=function(){f.prototypeSetup(),e={body:a("body"),webparts:a(g.webpart),webpartZone:a(g.zone)},e.webpartZone.sortable({connectWith:g.zone,handle:"span.js-webpart-titleCell",items:g.webpart}),e.body.on("mouseup",g.webpart,function(){var c,d=a(g.placeholder)[0];d&&(c=d.previousElementSibling,c&&c.id===h&&d.parentNode.insertBefore(d,c));var e=a(i)[0];e&&(b.MSOLayout_currentDragMode="move",b.MSOLayout_iBar.setAttribute("goodDrop",!0),b.MSOLayout_oDropLocation=e,b.MSOLayout_zoneDragOver=a(e).parents(".ms-SPZone")[0],b.MSOLayout_MoveWebPart(this,e)),this.setAttribute("style","")})},f.isEditMode=function(){var b,c,d;return c="1"===a("#MSOLayout_InDesignMode").val(),d="Edit"===a("#_wikiPageMode").val(),b=c||d},f.init=function(){HTMLDivElement.prototype.dragDrop===d&&f.isEditMode()&&a().sortable&&f.setup()},a(f.init)}(jQuery,window,document);